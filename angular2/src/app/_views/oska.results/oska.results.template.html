<breadcrumbs></breadcrumbs>
<div class="main-container">
  <mat-spinner *ngIf="!data && !error"></mat-spinner>
  <div class="row wrapper__row" *ngIf="data">
    <div class="col-8 sm-12">
      <div class="block border-blue padding-block">
        <div class="block__head no-border">
          <div class="block__head__title">{{ data['entityLabel'] | uppercase }}</div>
        </div><!--/block__head-->

        <h1>{{ 'oska.results' | translate }}</h1>
        <div class="mininav flex text-right">
          <favourites *ngIf="!userLoggedOut" [id]="data.nid" [title]="data.entityLabel"></favourites>
          <share></share>
        </div>  
        <div class="short" [attr.aria-label]="'description.short' | translate">
          {{ data['fieldResultPageIntroduction']}}
        </div>

        <!-- field image-->
        <ng-container *ngIf="data.fieldResultPagePicture">
          <ng-container *ngIf="data.fieldResultPagePicture.length > 0">
            <div class="article-image pull-right" *ngFor="let picture of data.fieldResultPagePicture">
              <img src="{{ picture.derivative.url }}" alt="{{ picture.alt }}" title="{{ picture.title }}" style="max-width:100%;" />
              <div aria-hidden="true" class="image-alt-text" *ngIf="picture.title">{{ picture.title }}</div>
            </div><!--/fieldOskaFieldPicture-->
          </ng-container>
        </ng-container>

        <div [innerHTML]="data['body']['value']" attr.aria-label="{{'description' | translate}}" class="description" ></div>

        <ng-container *ngIf="data.fieldResultPageLinks || data.fieldResultPageFiles">
          <ng-container *ngIf="data.fieldResultPageLinks.length > 0 || data.fieldResultPageFiles.length > 0" class="external-links">
            <ul class="external-links">
              <li *ngFor="let item of data.fieldResultPageLinks">
                <a href="{{ item.url.path }}" target="_blank" attr.aria-label="{{ item.title }}" ><span class="htm-icon">launch</span>{{ item.title }}</a>
              </li>
              <li *ngFor="let item of data.fieldResultPageFiles">
                <a href="{{ item.entity.url }}" target="_blank" attr.aria-label="{{ item.description || item.entity.entityLabel }}" ><span class="htm-icon">file_copy</span>{{ item.description || item.entity.entityLabel }}</a>
              </li>
            </ul>
          </ng-container>
        </ng-container>

        <ng-container *ngIf="data.fieldResultPageVideo">
          <video-component [videos]="data.fieldResultPageVideo"></video-component>
        </ng-container>

        <ng-container *ngIf="data.fieldResultPageGraph">
          <chart [data]="data.fieldResultPageGraph"></chart>
        </ng-container>
        
      </div><!--/block-->
    </div><!--/col-8-->

    <div class="col-4 sm-12" *ngIf="sidebarData">
      <oska-areas-sidebar [sidebar]="sidebarData" [viewType]="viewType"></oska-areas-sidebar>
    </div><!--/col-4-->
  
    <div class="col-8 sm-12" *ngIf="tableData">
      <div class="block border-blue padding-block lg-bottom" id="tableElem">
        <div class="block__head no-border">
          <div class="block__head__title">{{ 'TULEMUSTE TABEL' | uppercase }}</div>
        </div><!--/block__head-->
        <div class="download" *ngIf="data.fieldResultPageTableFile">
          <a href="{{ data.fieldResultPageTableFile.entity.url }}" target="_blank" attr.aria-label="{{ data.fieldResultPageTableFile.description || data.fieldResultPageTableFile.entity.entityLabel }}" >
            <span matTooltip="{{ 'button.download' | translate }}" matTooltipPosition="top" class="htm-icon">publish</span>
          </a>
        </div>
        <div class="scrollable" *ngIf="tableData">
          <div aria-hidden="true" class="scrollable__rectangle scrollable__rectangle--left pointer" id="scrollableLeft" *ngIf="!elemAtStart" 
            (touchstart)="tableService.scrollStart('resultsTable')" 
            (mousedown)="tableService.scrollStart('resultsTable')" 
            (touchend)="tableService.scrollEnd()" 
            (mouseup)="tableService.scrollEnd()">
            <span class="htm-icon">keyboard_arrow_left</span>
          </div>
          <div aria-hidden="true" class="scrollable__rectangle scrollable__rectangle--right pointer" id="scrollableRight" *ngIf="tableOverflown" 
            (touchstart)="tableService.scrollStart('resultsTable', true)"
            (mousedown)="tableService.scrollStart('resultsTable', true)"
            (touchend)="tableService.scrollEnd(true)"
            (mouseup)="tableService.scrollEnd(true)">
            <span class="htm-icon">keyboard_arrow_right</span>
          </div>
          <div class="scrollable__table" id="resultsTable" (scroll)="tableOverflown = tableService.isOverflownWhileScrolling($event); elemAtStart = tableService.isElemAtStart('resultsTable');setScrollPos('resultsTable')">
            <table class="dashboard-table scrollableTable">
              <thead>
                <tr>
                  <th>{{ 'oska.title_field' | translate }}</th>
                  <th>{{ 'oska.table_problem' | translate }}</th>
                  <th>{{ 'oska.table_proposition' | translate }}</th>
                  <th>{{ 'oska.table_responsible_person' | translate }}</th>
                  <th>{{ 'oska.table_proposition_status' | translate }}</th>
                  <th>{{ 'oska.table_experts_comment' | translate }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of tableData">
                  <td class="narrow"><ng-container *ngIf="item.oskaField && item.oskaField.length">{{ item.oskaField[0].entity.title }}</ng-container></td>
                  <td class="wide"><div>{{item.problemDescription}}</div></td>
                  <td class="wide"><div>{{item.proposal}}</div></td>
                  <td class="narrow"><div>{{item.responsible}}</div></td>
                  <td class="narrow"><div>{{item.proposalStatus}}</div></td>
                  <td class="wide"><div>{{item.expertCommentary}}</div></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div><!--/block-->
    </div><!--/col-8-->

  </div><!--/row-->
</div><!--/main-container-->