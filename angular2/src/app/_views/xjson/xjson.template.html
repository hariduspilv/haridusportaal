
<div>
  <breadcrumbs></breadcrumbs>
</div>
<div class="xjson main-container">
      <div class="block padding-block border-blue">
        <div class="block__head">
          <div class="block__head__title">{{ 'frontpage.dashboard_tabs_applications' | translate | uppercase }}</div>
          <div class="block__head__buttons">
            <div class="view-item" (click)="changeView('document')"
              attr.aria-label="{{ 'frontpage.dokument' | translate }}" tabindex="0"
              [class.active]="view === 'document'">
              <span class="htm-icon">insert_drive_file</span>
              <div class="title">{{ 'frontpage.dokument' | translate }}</div>
            </div>
            <div class="view-item" (click)="changeView('related_documents')"
              attr.aria-label="{{ 'frontpage.dashboard_related_documents' | translate }}" tabindex="0"
              [class.active]="view === 'related_documents'">
              <span class="htm-icon">call_split</span>
              <div class="title">{{ 'frontpage.dashboard_related_documents' | translate }}</div>
            </div>
          </div>
          <!--/block__head__buttons-->
        </div>
        <!--/block__head-->

        <loader *ngIf="!data || formLoading"></loader>

        <ng-container *ngIf="data && view == 'document' && !formLoading">

          <h1 *ngIf="data.body.title">{{ selectLanguage(data.body.title) }}</h1>
          <p class="xjson__introduction" *ngIf="data.body.introduction">{{ selectLanguage(data.body.introduction) }}</p>

          <ng-container *ngIf="data_messages">
            <ng-container *ngFor="let message of data_messages; let i = index;">
              <div class="alert" [ngClass]="'alert__'+data.messages[message].message_type | lowercase">
                {{ selectLanguage(data.messages[message].message_text)}}<button class="alert__close"
                  (click)="closeMessage(i)" [attr.aria-label]="'notification.close' | translate"></button></div>
            </ng-container>
          </ng-container>

          <ul class="xjson__navigation" id="stepNavigation" *ngIf="!data.body.hide_steps">
            <li class="xjson__navigation__step" [attr.id]="step" [class.active]="opened_step === step"
              [class.disabled]="isStepDisabled(step)" *ngFor="let step of objectKeys(data.body.steps)">
              <a (click)="selectStep(step)">
                <span class="xjson__navigation__stepname">
                  <ng-container *ngIf="data.body.steps[step].title"> {{ selectLanguage(data.body.steps[step].title) }}
                  </ng-container>
                </span>
              </a>
            </li>
          </ul>

          <ng-container *ngIf="!empty_data">
            <span>{{ 'xjson.required_fields_infotext' | translate }}</span>

            <hr class="divider">

            <!-- STEP BODY -->
            <div class="row button-list button-list-top">
              <ng-container *ngFor="let activity of activityButtons['primary']">
                <button *ngIf="activity.action == 'EDIT'" type="submit" role="button" mat-raised-button
                  [color]="[activity.style]" (click)="submitForm(activity.action)">
                  {{ activity.label | translate }}
                </button>
              </ng-container>
            </div>

            <div class="xjson__step-introduction" *ngIf="data.body.steps[opened_step].introduction">
              {{selectLanguage(data.body.steps[opened_step].introduction) }}
            </div>

            <form [class.disabled-step]="opened_step != this.max_step && !edit_step" (submit)="submitForm()"
              *ngIf="objectKeys(data_elements).length > 0">

              <ng-container *ngFor="let element of objectKeys(data_elements); let index = index;">

                <div [class]="data_elements[element].type != 'file' ? 'row' : 'file-row'" *ngIf="!data_elements[element].hidden">
                  <!-- Form elements -->

                  <div class="col-12 xjson__component">

                    <ng-container *ngIf="data_elements[element].type == 'helpertext'">
                      <p *ngIf="data_elements[element].title">
                        {{ selectLanguage(data_elements[element].title) }}
                      </p>
                    </ng-container> <!-- /HELPERTEXT (heading) -->

                    <ng-container *ngIf="data_elements[element].type == 'heading'">
                      <h1 class="xjson__heading" *ngIf="data_elements[element].title">
                        {{ selectLanguage(data_elements[element].title) }}
                      </h1>
                    </ng-container> <!-- /HEADING -->

                    <ng-container *ngIf="data_elements[element].type == 'text'">
                      <div class="squared-input__outer-wrapper">
                        <div class="squared-input__wrapper"
                          [class.complete]="data_elements[element].value || opened_step != this.max_step">
                          <span class="squared-input__title">
                            {{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                          </span>
                          <div class="squared-input__field-wrapper">
                            <input class="squared-input__field" type="text"
                              placeholder="{{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                              [attr.disabled]="isFieldDisabled(data_elements[element].readonly) ? '' : null"
                              [(ngModel)]='data_elements[element].value' [name]="element"
                              [attr.required]="data_elements[element].required" />
                          </div>
                        </div>
                        <!--/squared-input__wrapper-->

                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>
                    </ng-container> <!-- /TEXT -->

                    <ng-container *ngIf="data_elements[element].type == 'textarea'">
                      <div class="squared-input__area">

                        <div class="squared-input__outer-wrapper">
                          <div class="squared-input__wrapper"
                            [class.complete]="data_elements[element].value || opened_step != this.max_step">
                            <span class="xjson__textarea__info round-input__title">
                              {{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                            </span>
                            <div class="squared-input__area">
                              <textarea class="squared-input__area__elem"
                                [attr.disabled]="isFieldDisabled(data_elements[element].readonly) ? '' : null"
                                [(ngModel)]='data_elements[element].value'
                                placeholder="{{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                                [name]="element"></textarea>
                            </div>
                          </div>
                          <div class="helper-wrapper">
                            <ng-container *ngIf="data_elements[element].helpertext">
                              <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                                matTooltipPosition="above">
                              </span>
                            </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                          </div>
                        </div>
                      </div>
                    </ng-container> <!-- /TEXTAREA -->

                    <ng-container *ngIf="data_elements[element].type == 'selectlist'">
                      <div class="squared-input__outer-wrapper multiselect-wrapper">
                        <div class="squared-input__wrapper"
                          [class.complete]="data_elements[element].value || opened_step != this.max_step">
                          <span class="squared-input__title">
                            {{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                          </span>

                          <div class="squared-input__field-wrapper">
                            <mat-select class="squared-input__field"
                              placeholder=" {{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                              [(ngModel)]='data_elements[element].value'
                              [disabled]="isFieldDisabled(data_elements[element].readonly)" [name]="element"
                              [multiple]="data_elements[element].multiple">
                              <ng-container *ngIf="!data_elements[element].multiple">
                                <mat-option *ngIf="!data_elements[element].multiple" [value]="undefined">
                                  {{ data_elements[element].empty_option ? selectLanguage(data_elements[element].empty_option) : ''}}</mat-option>
                                  <ng-container *ngIf="data_elements[element].options">
                                  <ng-container *ngFor="let option of objectKeys(data_elements[element].options)">
                                  <mat-option *ngIf="!data_elements[element].options[option].options" [value]="option">
                                    {{ selectLanguage(data_elements[element].options[option]) }}
                                  </mat-option>

                                  <ng-container *ngIf="data_elements[element].options[option].options">
                                    <mat-option disabled="true" [value]="null">
                                      {{ selectLanguage(data_elements[element].options[option]) }}
                                    </mat-option>

                                    <ng-container
                                      *ngFor="let option2 of objectKeys(data_elements[element].options[option].options)">
                                      <!--level 2-->
                                      <mat-option
                                        *ngIf="!data_elements[element].options[option].options[option2].options"
                                        [value]="option2">
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{selectLanguage(data_elements[element].options[option].options[option2]) }}
                                      </mat-option>

                                      <ng-container
                                        *ngIf="data_elements[element].options[option].options[option2].options">
                                        <mat-option disabled="true" [value]="null">
                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{selectLanguage(data_elements[element].options[option]['options'][option2]) }}
                                        </mat-option>

                                        <ng-container
                                          *ngFor="let option3 of objectKeys(data_elements[element].options[option].options[option2].options)">
                                          <!--level 3-->
                                          <mat-option
                                            *ngIf="!data_elements[element].options[option].options[option2].options[option3].options"
                                            [value]="option3">
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{selectLanguage(data_elements[element].options[option].options[option2].options[option3])}}
                                          </mat-option>
                                        </ng-container>
                                      </ng-container>
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
                                </ng-container>
                              </ng-container>

                              <ng-container *ngIf="data_elements[element].multiple">
                                <mat-option *ngFor="let option of objectKeys(data_elements[element].options)"
                                  [value]="option">
                                  {{ selectLanguage(data_elements[element].options[option]) }}
                                </mat-option>
                              </ng-container>
                            </mat-select>
                          </div>
                        </div>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>
                    </ng-container> <!-- /SELECTLIST -->

                    <ng-container *ngIf="data_elements[element].type == 'email'">
                      <div class="squared-input__wrapper"
                        [class.complete]="data_elements[element].value || opened_step != this.max_step">
                        <span class="squared-input__title">
                          {{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                        </span>
                        <div class="squared-input__outer-wrapper">
                          <div class="squared-input__field-wrapper">
                            <input class="squared-input__field" type="email"
                              placeholder="{{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                              [attr.disabled]="isFieldDisabled(data_elements[element].readonly) ? '' : null"
                              [(ngModel)]='data_elements[element].value' [name]="element"
                              [attr.required]="data_elements[element].required" />
                          </div>
                          <div class="helper-wrapper">
                            <ng-container *ngIf="data_elements[element].helpertext">
                              <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                                matTooltipPosition="above">
                              </span>
                            </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                          </div>
                        </div>
                      </div>
                      <!--/squared-input__wrapper-->
                    </ng-container> <!-- /EMAIL -->

                    <ng-container *ngIf="data_elements[element].type == 'checkbox'">
                      <div class="squared-input__outer-wrapper checkbox-wrapper">
                        <div class="custom-checkbox">
                          <mat-checkbox [(ngModel)]="data_elements[element].value" [name]="element"
                            [disabled]="isFieldDisabled(data_elements[element].readonly)"
                            [required]="data_elements[element].required">
                            {{ selectLanguage(data_elements[element].title) }}{{data_elements[element].required ? '*': ''}}
                          </mat-checkbox>
                        </div>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>
                    </ng-container> <!-- /CHECKBOX -->

                    <ng-container *ngIf="data_elements[element].type == 'number'">
                      <div class="squared-input__wrapper"
                        [class.complete]="data_elements[element].value != undefined || opened_step != this.max_step">
                        <span class="squared-input__title">
                          {{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                        </span>
                        <div class="squared-input__outer-wrapper">
                          <div class="squared-input__field-wrapper">
                            <input class="squared-input__field" type="text" [min]="data_elements[element].min"
                              [max]="data_elements[element].max"
                              placeholder="{{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                              [(ngModel)]="data_elements[element].value"
                              [attr.disabled]="isFieldDisabled(data_elements[element].readonly) ? '' : null"
                              [name]="element" [attr.required]="data_elements[element].required" />
                          </div>
                          <div class="helper-wrapper">
                            <ng-container *ngIf="data_elements[element].helpertext">
                              <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                                matTooltipPosition="above">
                              </span>
                            </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                          </div>
                        </div>
                      </div>
                      <!--/squared-input__wrapper-->
                    </ng-container> <!-- /NUMBER -->

                    <ng-container *ngIf="data_elements[element].type == 'address'">
                      <div class="squared-input__outer-wrapper">
                        <div class="squared-input__wrapper"
                          [class.complete]="temporaryModel[element] || opened_step != this.max_step">
                          <span class="squared-input__title">
                            {{ selectLanguage(data_elements[element].title) }}{{data_elements[element].required ? '*': ''}}
                          </span>
                          <div class="squared-input__field-wrapper">
                            <input class="squared-input__field" type="text" matInput
                              [disabled]="isFieldDisabled(data_elements[element].readonly)"
                              [(ngModel)]="temporaryModel[element]"
                              placeholder="{{ selectLanguage(data_elements[element].title) }}{{data_elements[element].required ? '*': ''}}"
                              (ngModelChange)="addressAutocomplete(temporaryModel[element], 300, element)"
                              (focus)="addressFieldFocus = true" (blur)="validateInAdsField(element)" [name]="element"
                              [matAutocomplete]="autoAddress">
                            <mat-autocomplete #autoAddress="matAutocomplete"
                              (optionSelected)="addressFieldFocus = false">
                              <ng-container *ngIf="autocompleteLoader">
                                <mat-option [value]="" disabled="true">
                                  <span>{{'xjson.searching_please_wait' | translate }}</span>
                                </mat-option>
                              </ng-container>
                              <ng-container *ngIf="autocompleteLoader == false && autoCompleteContainer[element]">
                                <mat-option *ngIf="!autoCompleteContainer[element].length" [value]="" disabled="true">
                                  <span>{{'xjson.address_not_found' | translate }}</span>
                                </mat-option>
                                <ng-container *ngIf="autoCompleteContainer[element].length > 0">
                                  <mat-option *ngFor="let address of autoCompleteContainer[element]"
                                    [value]="address.addressHumanReadable">
                                    <span>{{ address.addressHumanReadable }}</span>
                                  </mat-option>
                                </ng-container>
                              </ng-container>
                            </mat-autocomplete>
                          </div>
                        </div>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>
                    </ng-container> <!-- /ADDRESS -->



                    <ng-container
                      *ngIf="data_elements[element].type == 'date' && !isFieldDisabled(data_elements[element].readonly)">
                      <div class="squared-input__outer-wrapper date-wrapper">
                        <div class="squared-input__wrapper"
                          [class.complete]="data_elements[element].value || opened_step != this.max_step">
                          <span class="squared-input__title">
                            {{selectLanguage(data_elements[element].title)}}{{ data_elements[element].required ? '*' : ''}}
                          </span>
                          <div class="squared-input__field-wrapper">
                            <input class="squared-input__field" matInput [matDatepicker]="picker"
                              [value]="getDatepickerValue(element)" readonly="true"
                              [(ngModel)]="data_elements[element].value" name="{{element}}"
                              (dateInput)="setDatepickerValue($event, element)"
                              (dateChange)="setDatepickerValue($event, element)" (focus)="datepickerFocus = true"
                              (blur)="datepickerFocus = false; setDatepickerValue($event, element)">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                          </div>
                        </div>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>
                    </ng-container> <!-- /DATE -->

                    <ng-container
                      *ngIf="data_elements[element].type == 'date' && isFieldDisabled(data_elements[element].readonly)">
                      <div class="squared-input__outer-wrapper">
                        <div class="squared-input__wrapper"
                        [class.complete]="data_elements[element].value || opened_step != this.max_step">
                          <span class="squared-input__title">
                            {{ selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}
                          </span>
                          <div class="squared-input__field-wrapper">
                          <input class="squared-input__field" type="text"
                          placeholder="{{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                            [attr.disabled]="isFieldDisabled(data_elements[element].readonly) ? '' : null"
                            [(ngModel)]="data_elements[element].value" name="{{element}}" />
                            </div>
                        </div>
                      <div class="helper-wrapper">
                        <ng-container *ngIf="data_elements[element].helpertext">
                          <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                            matTooltipPosition="above">
                          </span>
                        </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                      </div>
                    </div>
                    </ng-container><!-- /DATE -->

                    <ng-container *ngIf="data_elements[element].type == 'file'">

                      <div class="squared-input__outer-wrapper dropzone-wrapper">
                        <span class="xjson__heading">
                          {{selectLanguage(data_elements[element].title) }}{{data_elements[element].required ? '*': ''}}
                        </span>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" tooltipClass="AAAAAAAAAAA"
                              matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>

                      <div class="loaded-files-list">
                        <ng-container *ngIf="data_elements[element].value">
                          <ng-container *ngFor="let file of data_elements[element].value">
                            <div class="uploaded-file">
                              <a class="file-icon" [href]="fileDownloadlink(file.file_identifier)" target="_blank">
                                <span class="file-name">{{ file.file_name }}</span>
                              </a>
                              <a class="close-icn" href="javascript:void(0)"
                                *ngIf="!isFieldDisabled(data_elements[element].readonly)"
                                [class.disabled]="isFieldDisabled(data_elements[element].readonly)"
                                (click)="fileDelete(file.file_identifier, data_elements[element])"><span
                                  class="htm-icon">close</span>{{ 'xjson.delete_file' | translate }}</a>
                            </div>
                          </ng-container>
                        </ng-container>
                      </div>

                      <loader *ngIf="fileLoading[element]"></loader>
                      <div class="dropzone" (drop)="fileEventHandler($event, element)"
                        (dragover)="$event.preventDefault()" *ngIf="canUploadFile(data_elements[element]) && !fileLoading[element]">
                        <div class="dropzone-text">
                          <span class="dropzone-title">
                            {{ 'xjson.drag_files_here_or' | translate }}
                          </span>
                          <a class="dropzone-add" href="javascript:void(0)">
                            <input type="file" [attr.disabled]="canUploadFile(data_elements[element]) ? null : ''"
                              (change)="fileEventHandler($event, element)"
                              placeholder="{{selectLanguage(data_elements[element].title)}}{{data_elements[element].required ? '*': ''}}"
                              [accept]="parseAcceptableExtentsions(data_elements[element].acceptable_extensions)"
                              [attr.multiple]="data_elements[element].multiple ? '' : null" />
                            {{ 'button.upload' | translate }}
                          </a>
                          <span class="dropzone-description">Lubatud failitüübid:
                            {{ displayAcceptableExtentsions(data_elements[element].acceptable_extensions) }}</span>
                        </div>
                      </div>
                    </ng-container> <!-- /FILE -->


                    <ng-container *ngIf="data_elements[element].type == 'table'">
                      <div class="round-input__outer-wrapper table-wrapper">
                        <h1 class="xjson__heading" *ngIf="data_elements[element].title">
                            {{ selectLanguage(data_elements[element].title) }}
                        </h1>
                        <div class="helper-wrapper">
                          <ng-container *ngIf="data_elements[element].helpertext">
                            <span class="tooltip" matTooltip="{{ selectLanguage(data_elements[element].helpertext) }}"
                              matTooltipPosition="above">
                            </span>
                          </ng-container> <!-- /HELPERTEXT QUESTIONMARK (?) -->
                        </div>
                      </div>


                      <div class="xjson__scrollable">
                          <div class="xjson__scrollable">
                              <div class="xjson__scrollable__table" [attr.id]="'xjsonTable_' + index"
                                (scroll)="tableOverflown[index] = tableService.isOverflownWhileScrolling($event); elemAtStart[index] = tableService.isElemAtStart('xjsonTable_'+index)">
                                <div aria-hidden="true" class="xjson__scrollable__rectangle xjson__scrollable__rectangle--left pointer"
                                *ngIf="!elemAtStart[index]" (touchstart)="tableService.scrollStart('xjsonTable_'+index)"
                                (mousedown)="tableService.scrollStart('xjsonTable_'+index)"
                                (touchend)="tableService.scrollEnd()" (mouseup)="tableService.scrollEnd()">
                                <span class="htm-icon">keyboard_arrow_left</span>
                              </div>
                              <div aria-hidden="true" class="xjson__scrollable__rectangle xjson__scrollable__rectangle--right pointer"
                                *ngIf="tableOverflown[index]"
                                (touchstart)="tableService.scrollStart('xjsonTable_'+index, true)"
                                (mousedown)="tableService.scrollStart('xjsonTable_'+index, true)"
                                (touchend)="tableService.scrollEnd(true)" (mouseup)="tableService.scrollEnd(true)">
                                <span class="htm-icon">keyboard_arrow_right</span>
                              </div>
                                <table class="scrollableTable">
                                  <thead>
                                    <tr>
                                      <ng-container
                                        *ngFor="let col of objectKeys(data_elements[element].table_columns); let index = index">
                                        <ng-container *ngIf="!tableColumnAttribute(element, index, 'hidden')">
                                          <th>
                                            {{selectLanguage(data_elements[element].table_columns[col].title)}}
                                            {{data_elements[element].table_columns[col].required ? '*' : ''}}
                                          </th>
                                        </ng-container>
                                      </ng-container>
      
                                      <th
                                        *ngIf="data_elements[element].add_del_rows && !isFieldDisabled(data_elements[element].readonly)">
                                        <!-- extra column for action buttons -->
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngIf="!data_elements[element].value || !data_elements[element].value.length">
                                    <td [attr.colspan]="objectKeys(data_elements[element].table_columns).length">
                                      {{'xjson.data_missing' | translate }}
                                    </td>
                                  </tr>
                                    <tr *ngFor="let row of data_elements[element].value; let rowIndex = index;">
                                      <ng-container *ngFor="let col of objectKeys(row); let colIndex = index;">
      
                                        <td *ngIf="!tableColumnAttribute(element, colIndex, 'hidden')">
                                          <ng-container *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'text'">
                                            <input *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else readonlyDisplay" class="contnent-input" type="text"
                                              placeholder="{{selectLanguage(tableColumnAttribute(element, colIndex, 'title'))}}{{ tableColumnAttribute(element, colIndex, 'required') ? '*' : ''}}"
                                              [attr.disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')) ? '' : null"
                                              [(ngModel)]='row[col]' name="{{element + '_' + rowIndex + '_' + colIndex}}" />
                                          </ng-container> <!-- /TEXT -->
      
                                          <ng-container *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'address'">
                                              <input *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else readonlyDisplay" class="contnent-input" type="text" matInput
                                              [disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly'))"
                                              placeholder="{{selectLanguage(tableColumnAttribute(element, colIndex, 'title'))}}{{ tableColumnAttribute(element, colIndex, 'required') ? '*' : ''}}"
                                              [(ngModel)]="row[col]" [name]="element + '_' + rowIndex + '_' + colIndex"
                                              (ngModelChange)="addressAutocomplete(row[col], 300, element, false, col, rowIndex, true)"
                                              (focus)="addressFieldFocus = true" (blur)="validateInAdsFieldTable(row[col])"
                                              [matAutocomplete]="autoAddress">
                                            <mat-autocomplete #autoAddress="matAutocomplete"
                                              (optionSelected)="addressFieldFocus = false">
                                              <ng-container *ngIf="autocompleteLoader">
                                                <mat-option [value]="" disabled="true">
                                                  <span>{{'xjson.searching_please_wait' | translate }}</span>
                                                </mat-option>
                                              </ng-container>
                                              <ng-container
                                                *ngIf="autocompleteLoader == false && autoCompleteContainer[element]">
                                                <mat-option *ngIf="!autoCompleteContainer[element].length" [value]=""
                                                  disabled="true">
                                                  <span>{{'xjson.address_not_found' | translate }}</span>
                                                </mat-option>
                                                <ng-container *ngIf="autoCompleteContainer[element].length > 0">
                                                  <mat-option *ngFor="let address of autoCompleteContainer[element]"
                                                    [value]="address.addressHumanReadable">
                                                    <span>{{ address.addressHumanReadable }}</span>
                                                  </mat-option>
                                                </ng-container>
                                              </ng-container>
                                            </mat-autocomplete>
                                          </ng-container> <!-- /ADDRESS -->
      
                                          <ng-container *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'email'">
                                              <input *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else readonlyDisplay" class="contnent-input" type="email"
                                              [attr.disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly'))"
                                              placeholder="{{selectLanguage(tableColumnAttribute(element, colIndex, 'title'))}}{{ tableColumnAttribute(element, colIndex, 'required') ? '*' : ''}}"
                                              [readonly]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly'))"
                                              [(ngModel)]='row[col]' name="{{element + '_' + rowIndex + '_' + colIndex}}" />
                                          </ng-container> <!-- /EMAIL -->
      
                                          <ng-container *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'number'">
                                              <input *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else readonlyDisplay" class="contnent-input" type="text"
                                              [min]="tableColumnAttribute(element, colIndex, 'min')"
                                              [max]="tableColumnAttribute(element, colIndex, 'max')"
                                              [attr.disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')) ? true : null"
                                              [(ngModel)]='row[col]' name="{{element + '_' + rowIndex + '_' + colIndex}}" />
                                          </ng-container> <!-- /NUMBER -->
      
                                          <ng-container
                                            *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'date'">
                                            <div *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else readonlyDisplay" class="round-input__wrapper">
                                              <div class="round-input__field-wrapper">
                                                <input class="round-input__field" matInput [matDatepicker]="picker"
                                                  [value]="getDatepickerValue(element, rowIndex, col)" readonly="true"
                                                  [(ngModel)]='data_elements[element].value[rowIndex][col]'
                                                  name="{{element + '_' + rowIndex + '_' + colIndex}}"
                                                  (dateInput)="setDatepickerValue($event, element, rowIndex, col)"
                                                  (dateChange)="setDatepickerValue($event, element, rowIndex, col)"
                                                  (focus)="datepickerFocus = true"
                                                  (blur)="datepickerFocus = false; setDatepickerValue($event, element, rowIndex, col)">
                                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                                <mat-datepicker #picker></mat-datepicker>
                                              </div>
                                            </div>
                                          </ng-container><!-- /DATE -->

      
                                          <ng-container *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'checkbox'">
                                            <div *ngIf="!isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')); else checkboxReadonlyDisplay"class="custom-checkbox">
                                              <mat-checkbox [(ngModel)]="row[col]"
                                                name="{{element + '_' + rowIndex + '_' + colIndex}}"
                                                [disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly'))">
                                              </mat-checkbox>
                                            </div>
                                          </ng-container> <!-- /CHECKBOX -->
                                          <ng-template #checkboxReadonlyDisplay>
                                              <span>{{ (row[col] ? 'true' : 'false') | translate }}</span>
                                            </ng-template> <!-- /CHECKBOX DISABLED -->
      
                                          <ng-container
                                            *ngIf="tableColumnAttribute(element, colIndex, 'type') == 'selectlist'">
                                            <ng-container
                                              *ngIf="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly')) == false; else readonlyDisplay">
                                              <div class="round-input__wrapper"
                                                [class.complete]="data_elements[element].value || opened_step != this.max_step">
                                                <div class="round-input__field-wrapper">
                                                  <mat-select class="round-input__field"
                                                    [disabled]="isFieldDisabled(tableColumnAttribute(element, colIndex, 'readonly'))"
                                                    [(ngModel)]="row[col]"
                                                    name="{{element + '_' + rowIndex + '_' + colIndex}}"
                                                    placeholder="{{ tableColumnAttribute(element, colIndex, 'empty_option') ? selectLanguage(tableColumnAttribute(element, colIndex, 'empty_option')) : ''}}">
                                                    <mat-option>
                                                      {{ tableColumnAttribute(element, colIndex, 'empty_option') ?
                                                selectLanguage(tableColumnAttribute(element, colIndex, 'empty_option')) : '-'}}
                                                    </mat-option>
                                                    <mat-option
                                                      *ngFor="let option of objectKeys(tableColumnAttribute(element, colIndex, 'options'))"
                                                      [value]="option">
                                                      {{ selectLanguage(tableColumnAttribute(element, colIndex, 'options')[option]) }}
                                                    </mat-option>
                                                  </mat-select>
                                                </div>
                                              </div>
                                            </ng-container>
                                          </ng-container> <!-- /SELECTLIST -->
      
                                          <ng-template #readonlyDisplay>
                                              <span>{{ row[col] }}</span>
                                          </ng-template>
      
                                          <ng-container *ngIf="error[element]">
                                            <!-- START OF TABLE COLUMN VALIDATION ERROR MESSAGE -->
                                            <ng-container
                                              *ngIf="error[element].row == rowIndex && error[element].column == col">
                                              <div class="error">
                                                {{ error[element].message }}
                                              </div>
                                            </ng-container>
                                          </ng-container> <!-- END OF TABLE COLUMN VALIDATION ERROR MESSAGE -->
      
                                        </td>
                                      </ng-container> <!-- END OF *NGFOR COLUMNS-->
                                      <td
                                        *ngIf="data_elements[element].add_del_rows && !isFieldDisabled(data_elements[element].readonly)">
                                        <div>
                                          <a class="table-link" href="javascript:void(0);"
                                            (click)="tableDeleteRow(element, rowIndex)">
                                            {{ 'button.delete_table_row' | translate }}
                                          </a>
                                        </div>
                                      </td>
                                    </tr> <!-- END OF *NGFOR COLUMNS-->
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                      
                      <div class="add-row"
                        *ngIf="data_elements[element].add_del_rows && !isFieldDisabled(data_elements[element].readonly)">
                        <div>
                          <a class="table-link" href="javascript:void(0);" (click)="tableAddRow(element)">
                            + {{ 'button.add_table_row' | translate }}
                          </a>
                        </div>
                      </div> <!-- ADD_DEL_ROWS -->

                    </ng-container> <!-- /TABLE -->

                    <ng-container *ngIf="error[element] && error[element].row == undefined">
                      <div class="error">
                        {{ error[element].message }}
                      </div>
                    </ng-container> <!-- FIELD VALIDATION ERROR MESSAGE -->

                  </div>
                  <!--/col-12-->
                </div> <!-- row -->
              </ng-container>
            </form>

            <hr class="divider">

            <div [class]="navigationLinks.length > 0 ? 'row button-list separate' : 'row button-list'">
              <ng-container *ngFor="let activity of activityButtons['primary']">
                <div class="subrow">
                  <button *ngIf="activity.action == 'EDIT'" type="submit" role="button" mat-raised-button
                    [color]="[activity.style]" (click)="submitForm(activity.action)">
                    {{ activity.label | translate }}
                  </button>
                </div>
              </ng-container>


              <div *ngIf="navigationLinks.length > 0" class="secondary-buttons">
                <ng-container *ngFor="let link of navigationLinks">
                  <a *ngIf="link.type === 'link'" href="javascript:void(0);"
                    (click)="selectStep(link.step)">{{ link.label | translate }}</a>
                  <button *ngIf="link.type === 'button'" type="submit" role="button" mat-raised-button
                    [color]="['primary']" (click)="selectStep(link.step)">{{ link.label | translate }}</button>
                </ng-container>
                </div>

                <div class="primary-buttons">
                    <button type="submit" role="button" mat-raised-button [color]="['alternative']" (click)="returnToPreviousUrl()">
                        {{ 'button.cancel' | translate }}
                      </button>
                      <ng-container *ngFor="let activity of activityButtons['primary']">
                        <button *ngIf="activity.action != 'EDIT'" type="submit" role="button" mat-raised-button
                          [color]="[activity.style]" (click)="submitForm(activity.action)">
                          {{ activity.label | translate }}
                        </button>
                      </ng-container>
                </div>

              <ng-container *ngFor="let activity of activityButtons['secondary']">
                    <div class="subrow" *ngIf="activityButtons['secondary'].length">
                        <a href="javascript:void(0);"
                          (click)="submitForm(activity.action)">{{ activity.label | translate }}</a>
                      </div> <!-- /row button-list -->
              </ng-container>
            </div> <!-- /row button-list -->
          </ng-container> <!-- /if !empty_data-->
        </ng-container> <!-- /if data-->
        <ng-container *ngIf="data && view == 'related_documents'">
          <div class="xjson__title">{{ 'frontpage.dashboard_related_documents' | translate }}</div>
          <p class="xjson__introduction" *ngIf="data.body.introduction">{{ selectLanguage(data.body.introduction) }}</p>

          <ng-container *ngIf="acceptable_forms.length">
            <div class="grid-box">
              <ng-container *ngFor="let form of acceptable_forms">
                <a [href]="form.link" class="grid-item">
                  <span class="grid-link">{{ form.form_name }}</span>
                </a>
              </ng-container>
            </div>

            <ng-container
              *ngIf="data.header.acceptable_forms.length > acceptable_forms_limit && acceptable_forms_list_restricted == true">
              <div class="grid-load">
                <a href="javascript:void(0);" (click)="toggleAcceptableFormList()">+
                  {{ 'button.show_more' | translate }}
                  ({{ data.header.acceptable_forms.length - acceptable_forms_limit }})</a>
              </div>
            </ng-container>
            <ng-container *ngIf="acceptable_forms_list_restricted == false">
              <div class="grid-load">
                <a href="javascript:void(0);" (click)="toggleAcceptableFormList()">-
                  {{ 'button.show_less' | translate }}</a>
              </div>
            </ng-container>


          </ng-container>
        </ng-container>
      </div>
      <!--/block border-blue-->
</div>
<!--/main-container-->