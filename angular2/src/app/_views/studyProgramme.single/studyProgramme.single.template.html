<div><breadcrumbs *ngIf="!inputData"></breadcrumbs></div>

<div class="main-container">
  <loader *ngIf="!data || !relatedInitialized"></loader>

  <div class="row" *ngIf="data" [style.visibility]="relatedInitialized ? 'visible' : 'hidden'">
    <div class="col-8 sm-12">
      <div class="block padding-block lg-bottom--extra">

        <div class="block-title">{{ 'studyProgramme.label' | translate }}</div>
        <div class="row title">
          <div class="col-12">
            <h1 *ngIf="data.entityLabel">{{ data.entityLabel }}</h1>
          </div><!--/col-8-->
          <div class="mininav col-12 flex text-right">
            <favourites *ngIf="!userLoggedOut" [state]="data.isFavorite" [id]="data.nid" [title]="data.entityLabel"></favourites>
            <share [title]="data.entityLabel"></share>
            <compare [id]="data.nid" sessionStorageKey="studyProgramme.compare"></compare>
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr *ngIf="data.fieldEducationalInstitution && data.fieldEducationalInstitution.entity">
                    <th>Õppeasutuse nimi</th>
                    <th>{{ data.fieldEducationalInstitution.entity.entityLabel | titleCase }}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="data.fieldEducationalInstitution && data.fieldEducationalInstitution.entity">
                    <td>Registrikood</td>
                    <td>{{ data.fieldEducationalInstitution.entity.fieldRegistrationCode }}</td>
                  </tr>

                  <tr *ngIf="data.fieldStudyProgrammeLevel">
                    <td>Õppekava tase</td>
                    <td>{{ returnEntityString(data.fieldStudyProgrammeLevel) | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldDegreeOrDiplomaAwarded && data.fieldDegreeOrDiplomaAwarded.entity">
                    <td>Omistatav kraad või diplom</td>
                    <td>{{ data.fieldDegreeOrDiplomaAwarded.entity.entityLabel | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldSpecialization">
                    <td>Spetsialiseerumine</td>
                    <td>{{ data.fieldSpecialization | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldIscedfBoard && data.fieldIscedfBoard.entity">
                    <td>Õppevaldkond</td>
                    <td>{{ data.fieldIscedfBoard.entity.entityLabel | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldIscedfNarrow && data.fieldIscedfNarrow.entity">
                    <td>Õppesuund</td>
                    <td>{{ data.fieldIscedfNarrow.entity.entityLabel | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldIscedfDetailed && data.fieldIscedfDetailed.entity">
                    <td>Õppekavarühm</td>
                    <td>{{ data.fieldIscedfDetailed.entity.entityLabel | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldShortDescription">
                    <td>Lühikirjeldus</td>
                    <td>{{ data.fieldShortDescription | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldTeachingLanguage && data.fieldTeachingLanguage.length">
                    <td>Õppekeel(ed)</td>
                    <td>
                      <ng-container *ngFor="let item of data.fieldTeachingLanguage; let i = index;">
                        <ng-container *ngIf="i > 0">, </ng-container>{{ item.entity.entityLabel | titleCase }}
                      </ng-container>
                    </td>
                  </tr>

                  <tr *ngIf="data.fieldAmount">
                    <td>Õppekava maht</td>

                    <td>{{ data.fieldAmount }} {{ data.fieldAmountUnit | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldPracticalTrainingAmount">
                    <td>Praktika maht</td>
                    <td>{{ data.fieldPracticalTrainingAmount }} {{ data.fieldAmountUnit }}</td>
                  </tr>

                  <tr *ngIf="data.fieldDuration">
                    <td>Nominaalkestus</td>
                    <td>
                     {{data.fieldDuration | monthsToYears }}
                    </td>
                  </tr>

                  <tr *ngIf="data.fieldAdmissionStatus">
                    <td>Vastuvõtu olek</td>
                    <td>{{ data.fieldAdmissionStatus | titleCase }}</td>
                  </tr>

                  <tr *ngIf="data.fieldWebPageAddress">
                    <td>Õppekava kirjeldava veebilehe aadress</td>
                    <td><a href="{{ data.fieldWebPageAddress.uri }}" target="_blank">Vaata õppekava kirjeldust õppeasutuse veebilehel</a></td>
                  </tr>

                  <tr *ngIf="data.fieldQualificationStandardId && data.fieldQualificationStandardId.length > 0">
                    <td>Kutsestandard(id)</td>
                    <td>
                      <ng-container *ngFor="let item of data.fieldQualificationStandardId">
                        {{ item.entity.entityLabel | titleCase }}<br />
                      </ng-container>
                    </td>
                  </tr>

                </tbody>
              </table>
            </div><!--/table-wrapper-->
          </div>
        </div>
        <feedback class="sm-hide" [nid]="data.nid" *ngIf="data"></feedback>
      </div><!--/block-->

      <ng-container *ngIf="desktopView">
        <div class="text-center actions snackBar sm-hide" *ngIf="!displayRelatedStudyProgrammes">
          <button mat-raised-button color="primary" (click)="displayRelatedStudyProgrammes = true" >Vaata sarnaseid erialasid</button>
        </div><!--/text-center-->
        <related-studyprogrammes (initialized)="onInitialized($event)" class="sm-hide" *ngIf="displayRelatedStudyProgrammes" [studyProgrammeId]="data.nid"></related-studyprogrammes>
      </ng-container>
      
    </div><!--/col-8-->
    <div class="col-4 sm-12">
      <div class="block padding-block border-orange">
        <h2>Kontakt</h2>
        <p>
          <ng-container *ngIf="data.fieldEducationalInstitution.entity">{{ data.fieldEducationalInstitution.entity.entityLabel | titleCase }}<br /></ng-container>
          <ng-container tabindex="0" *ngIf="data.fieldEducationalInstitution.entity.fieldSchoolContactPhone"><span role="text" tabindex="0" attr.aria-label="{{' event.phone: ' | translate}} {{ data.fieldEducationalInstitution.entity.fieldSchoolContactPhone }}"> {{data.fieldEducationalInstitution.entity.fieldSchoolContactPhone }}</span><br /></ng-container>
          <ng-container *ngIf="data.fieldEducationalInstitution.entity.fieldSchoolContactEmail"><a tabindex="0" attr.aria-label="{{' E-mail: '}} {{ data.fieldEducationalInstitution.entity.fieldSchoolContactEmail }} " href="mailto:data.fieldEducationalInstitution.entity.fieldSchoolContactEmail">{{ data.fieldEducationalInstitution.entity.fieldSchoolContactEmail }}</a><br /></ng-container>
          <ng-container *ngIf="data.fieldSchoolWebsite"><a  tabindex="0" attr.aria-label="{{' event.website: '}} {{ data.fieldSchoolWebsite | removeProtocol }}" href="{{ data.fieldSchoolWebsite | url }}" target="_blank">{{ data.fieldSchoolWebsite | removeProtocol }}</a></ng-container>
        </p>
      </div><!--/block-->
      

      <ng-container *ngFor="let item of data.fieldEducationalInstitution.entity.fieldSchoolLocation; let i = index">
        <div class="block padding-block border-orange mob-bottom" *ngIf="item.entity.fieldLocationType == 'L'">

          <map-wrapper tabindex="-1" [latitude]="parseFloat(item.entity.fieldCoordinates.lat)" [longitude]="parseFloat(item.entity.fieldCoordinates.lon)" zoom="11"></map-wrapper>

          <h2>Juriidiline aadress</h2>
          <p>{{ item.entity.fieldAddress | titleCase }}</p>
        </div><!--/block-->
      </ng-container>
      <ng-container *ngIf="!desktopView">
        <div class="text-center actions snackBar sm-show" *ngIf="!displayRelatedStudyProgrammes">
          <button role="button" mat-raised-button color="primary" (click)="displayRelatedStudyProgrammes = true">Vaata sarnaseid erialasid</button>
        </div><!--/text-center-->
        <related-studyprogrammes (initialized)="onInitialized($event)" class="sm-show" *ngIf="displayRelatedStudyProgrammes" [studyProgrammeId]="data.nid"></related-studyprogrammes>
      </ng-container>
      <feedback class="feedback--sm sm-show" [nid]="data.nid" *ngIf="data"></feedback>
    </div><!--/col-4-->
  </div><!--/row-->
</div>