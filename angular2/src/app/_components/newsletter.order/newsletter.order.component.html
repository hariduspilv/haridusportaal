<div class="block">
  <mat-spinner *ngIf="!data && !subscribedStatus"></mat-spinner>
  <div class="block__content" *ngIf="data">
    <div class="block__content--header">
      <h1>{{ 'newsletter.title' | translate }}</h1>
      <div class="intro">{{ 'newsletter.intro' | translate }}</div>
    </div>
    <form class="block__content--form" (ngSubmit)="submit()">

      <div class="block__content--form__checklist">
        <div class="block__content--form__checklist__elem" *ngFor="let item of data">
          <label class="checkbox__container pointer">
            <span class="label">{{ item.entityLabel }}</span>
            <input type="checkbox" [(ngModel)]='formItems[item.entityId]' [name]="item.entityId" (change)="updateRSSLink()">
            <span class="checkmark"></span>
          </label>
        </div>
      </div><!--block__content--form__checklist-->

      <div class="block__content--form__input">
        <div class="row">
          <div class="col-8 sm-12">
            <div class="round-input__wrapper" [class.error]="errors.email && !emailFocus">
              <span class="round-input__title" [class.exists]="email">{{ 'newsletter.email' | translate }}</span>
              <div class="round-input__field-wrapper" [class.spacing]="email">
                <input class="round-input__field" (focus)="emailFocus = true" (blur)="emailFocus = false" [class.focused]='emailFocus' name="email" placeholder="{{ 'newsletter.email' | translate }}" [(ngModel)]="email"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text" *ngIf="!emailFocus">
                  <span *ngIf="errors.items" role="alert">{{ 'newsletter.subscription_choose_one' | translate }}</span>
                  <span *ngIf="errors.email && !errors.items" role="alert">{{ 'newsletter.valid_email' | translate }}</span>
                </div>
              </div>
            </div>
          </div><!--/col-8-->
          <div class="col-4 sm-12">
            <button mat-raised-button color="primary">{{ 'button.newsletter_submit' | translate }} </button>
          </div><!--/col-4-->
        </div>
      </div><!--block__content--form__input-->

      <a href="http://test-htm.wiseman.ee:30000/et/custom/rss.xml{{ rssIDs }}" target="_blank">Rss feed</a>
    </form><!--block__content--form-->
  </div><!--block__content-->

  <div class="block__content--message" *ngIf="subscribedStatus && !subscribedFailure">
    <div class="block__content--message__content" role="alert">{{ 'newsletter.subscription_thanks_content' | translate }}</div>
    <div class="block__content--message__subcontent" role="alert">{{ 'newsletter.subscription_thanks_subcontent' | translate }} <b>{{email}}</b>.</div>
  </div>
  <div class="block__content--message" *ngIf="subscribedStatus && subscribedFailure">
    <div class="block__content--message__content" role="alert">{{ 'newsletter.subscription_failed' | translate }}</div>
    <div class="block__content--message__subcontent" role="alert">{{ subscribedFailure }}</div>
  </div>
</div><!--block-->