<div class="dialog" cdkTrapFocus>
  <div class="row">
    <div class="col-12" style="position: relative;">
      <span class="dialog__text--medium">{{ 'form.registration' | translate | uppercase }}</span>
      <mat-icon class="dialog__close" aria-label="Close" (click)="close()" tabindex="0">close</mat-icon>
    </div>

    
    <div class="col-12" *ngIf="step === 0 && !loader">
      <h1>{{ data.eventTitle }}</h1>
      <div class="dialog__time"> 
        <span class="capitalize">{{ data.eventStartDate.fieldEventDate.unix*1000 | weekday: "unix" | lowercase | translate }} {{ data.eventStartDate.fieldEventDate.unix*1000 | date: "dd.MM"}}</span>
        <span>{{ 'time.at' | translate }}</span>
        <span>{{ data.eventStartDate.fieldEventStartTime | unixToTime }} - {{ data.eventStartDate.fieldEventEndTime | unixToTime }}</span>
      </div>
      <div class="dialog__required">* {{ 'required.fields' | translate }}</div>
    </div><!--/col-12-->
    <form [formGroup]="form" class="dialog__form col-12" *ngIf="step === 0 && !loader">
      <div class="dialog-content">
        <div class="row">
          <div class="col-6 sm-12">
            <div class="round-input__wrapper">
              <span class="round-input__title">{{ 'participantFirstName' | translate }} *</span>
              <div class="round-input__field-wrapper">
                <input maxlength="30" class="round-input__field" placeholder="{{ 'participantFirstName' | translate }} *" formControlName="firstName"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text" *ngIf="isInvalidField('firstName') && form.controls.firstName.errors.required">
                  {{ 'required.field' | translate }}
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-6 sm-12">
            <div class="round-input__wrapper">
              <span class="round-input__title">{{ 'participantLastName' | translate }} *</span>
              <div class="round-input__field-wrapper">
                <input maxlength="30" class="round-input__field" placeholder="{{ 'participantLastName' | translate }} *" formControlName="lastName"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text" *ngIf="isInvalidField('lastName') && form.controls.lastName.errors.required">
                  {{ 'required.field' | translate }}
                </div>
              </div>
            </div>
          </div>
        
          <div class="col-12 sm-12">
            <div class="round-input__wrapper">
              <span class="round-input__title">{{ 'participantOrganization' | translate }}</span>
              <div class="round-input__field-wrapper">
                <input maxlength="60" class="round-input__field" placeholder="{{ 'participantOrganization' | translate }}" formControlName="companyName"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text"></div>
              </div>
            </div>
          </div>
        
          <div class="col-6 sm-12">
            <div class="round-input__wrapper" 
              [class.error]="isInvalidField('email') && form.controls.email.errors.email && !emailFocus" 
              [class.complete]="!isInvalidField('email') && form.controls.email.value && !emailFocus">
              <span class="round-input__title">{{ 'participantEmail' | translate }} *</span>
              <div class="round-input__field-wrapper">
                <input maxlength="30" class="round-input__field" (focus)="emailFocus = true" (blur)="emailFocus = false" [class.focused]='emailFocus' placeholder="{{ 'participantEmail' | translate }} *" formControlName="email"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text" *ngIf="isInvalidField('email') && form.controls.email.errors.email && !emailFocus">
                  {{ 'enter.valid.email' | translate }}
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-6 sm-12">
            <div class="round-input__wrapper" [class.complete]="form.controls.telephone.value && !phoneFocus">
              <span class="round-input__title">{{ 'participantPhone' | translate }}</span>
              <div class="round-input__field-wrapper">
                <input maxlength="30" class="round-input__field" (focus)="phoneFocus = true" (blur)="phoneFocus = false" [class.focused]='phoneFocus' placeholder="{{ 'participantPhone' | translate }}" formControlName="telephone"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text"></div>
              </div>
            </div>
          </div>

          <!-- <div class="col-12 sm-12">
            <div class="round-input__wrapper">
              <span class="round-input__title">{{ 'participantComment' | translate }}</span>
              <div class="round-input__field-wrapper">
                <input class="round-input__field" placeholder="{{ 'participantComment' | translate }}" formControlName="marked"/>
              </div>
              <div class="round-input__error">
                <div class="round-input__error--text"></div>
              </div>
            </div>
          </div> -->
          
          <div class="col-12 sm-12">
            <div class="round-input__area">
              <textarea class="round-input__area__elem" autosize placeholder="{{ 'participantComment' | translate }}" formControlName="marked"></textarea>
            </div>
          </div>

        </div>
      </div>

      <div class="dialog__actions row" *ngIf="step === 0 && !loader">
        <div class="col-12 text-right">
          <a class="sm-hide" href="javascript:void(0)" (click)="clear()">{{ 'cancel' | translate }}</a>
          <button [disabled]="form.status === 'INVALID'" mat-raised-button color="primary" (click)="save()">{{ 'send' | translate }}</button>
          <a class="sm-show" href="javascript:void(0)" (click)="clear()">{{ 'cancel' | translate }}</a>
          <!-- [disabled]="form.invalid" -->
        </div>
      </div>
    </form>

    <div class="col-12" *ngIf="loader">
      <mat-spinner></mat-spinner>
    </div><!--/col-12-->
    
    <div class="dialog__success" *ngIf="step === 1">
      <div class="dialog__success__title">
        <h1>{{ 'registration.thanks' | translate }}</h1>
      </div>
      <div class="dialog__actions--success">
        <div class="row text-center">
          <div class="col-12">
            <button mat-raised-button color="primary" (click)="close()">{{ 'registration.add.to.calendar' | translate }}</button>
          </div>
          <div class="dialog__actions--success__close col-12"><a href="javascript:void(0)" (click)="close()">{{ 'modal.close' | translate }}</a></div>
        </div>
      </div>
    </div>
  </div>
</div>
