<div class="events__list__recent">
  <div class="events__list__item register">
    <div *ngIf="content.entity.fieldEntryType == 'register' && content.entity.fieldRegistrationDate.entity && !content.entity.EventRegistrations">
      <div class="title"><h1>{{'event.registration' | translate}}</h1></div>

      <div class="events__list__item__body">
        <span class="child" *ngIf="canRegister() == true" tabindex="0">
          {{'button.register' | translate}} {{'time.from' | translate | lowercase}} {{ content.entity.fieldRegistrationDate.entity.fieldRegistrationFirstDate.unix*1000 | date:'dd.MM.yyyy' }} {{'time.to' | translate | lowercase}} {{ content.entity.fieldRegistrationDate.entity.fieldRegistrationLastDate.unix*1000 | date:'dd.MM.yyyy' }}
        </span>
        <span class="error" *ngIf="canRegister() == 'ended'" role="alert">{{'event.registration_ended' | translate}}</span>
        <span class="error" *ngIf="canRegister() == 'not_started'" role="alert">{{'event.registration_not_started' | translate}}</span>
        <span class="error" *ngIf="canRegister() == 'full'" role="alert">{{'event.registration_full' | translate}}</span>
      </div>

      <ng-container *ngIf="content.entity.fieldEntryType == 'register' && canRegister() == true">
        <button mat-raised-button color="primary" (click)="openDialog()">{{'button.register' | translate}}</button>
        <div class="calendar__add"><a href="{{ iCalUrl }}{{ nid }}">{{'button.calendar_add' | translate}}</a></div>
      </ng-container>

    </div>

    <div *ngIf="content.entity.fieldEntryType == 'juhan'">
      <div class="title"><h1>{{'event.registration' | translate}}</h1></div>

      <ng-container  *ngIf="content.entity.fieldEventLink && content.entity.fieldEventLink[0]">
        <a target="_blank" [href]="content.entity.fieldEventLink[0].url.path" class="no-break">{{ 'event.registration_link' | translate }}</a>
      </ng-container>
    </div>

    <div *ngIf="content.entity.fieldEntryType == 'external_inv'">
      <div class="title"><h1>{{'event.registration' | translate}}</h1></div>

      <ng-container  *ngIf="content.entity.fieldRegistrationUrl">
        <a target="_blank" [href]="content.entity.fieldRegistrationUrl.url.path" class="no-break">{{ 'event.external_registration' | translate }}</a>
      </ng-container>
    </div>

    
    <div *ngIf="content.entity.fieldEntryType && content.entity.fieldEntryType == 'free' && !content.entity.EventRegistrations">
      <div class="title"><h1>{{'event.entrance' | translate}}</h1></div>
      <div class="events__list__item__body">
        <span class="child" *ngIf="canRegister() !== 'ended'" >{{'event.free' | translate}}</span>
        <span class="error" *ngIf="canRegister() == 'ended'">{{'event.passed' | translate}}</span>
      </div>
    </div>
    <div *ngIf="content.entity.fieldEntryType && content.entity.fieldEntryType == 'invite'">
      <div class="title"><h1>{{'event.entrance' | translate}}</h1></div>
      <div class="events__list__item__body">
        <span class="child" *ngIf="canRegister() !== 'ended'">{{'event.invite' | translate}}</span>
        <span class="error" *ngIf="canRegister() == 'ended'" >{{'event.passed' | translate}}</span>
      </div>
    </div>
    <ng-container *ngIf="content.entity.EventRegistrations">
      <div class="title"><h1>{{'event.participant_list' | translate}}</h1></div>
      <button mat-raised-button color="primary" (click)="toggleParticipants(true)">{{'event.participants_list_view' | translate}}</button>
    </ng-container>
  </div>
</div>

<div class="events__list__recent">
  <map-wrapper [latitude]="parseFloat(map.lat)" [longitude]="parseFloat(map.lon)" zoom="11" *ngIf="map"></map-wrapper>
  <div class="events__list__item">

    <div class="title"><h1 attr.aria-label="{{'event.place_and_time' | translate}}" tabindex="0">{{'event.place_and_time' | translate}}</h1></div>
    <div tabindex="0">
      <ng-container [ngSwitch]="content.entity.fieldEntryType">
        <ng-container *ngSwitchCase="'juhan'">
          {{ content.entity.fieldEventMainDate.unix*1000 | date: 'dd.MM.yyyy' }}
          <ng-container *ngIf="content.entity.fieldEventMainDate && content.entity.fieldEventMainEndDate && content.entity.fieldEventMainDate.unix !== content.entity.fieldEventMainEndDate.unix"> - </ng-container>
          <ng-container *ngIf="content.entity.fieldEventMainEndDate && content.entity.fieldEventMainDate.unix !== content.entity.fieldEventMainEndDate.unix">
            {{ content.entity.fieldEventMainEndDate.unix*1000 | date: 'dd.MM.yyyy' }}
          </ng-container>
        </ng-container>

        <ng-container *ngSwitchDefault>
          <div class="events__list__item__body">
            <div *ngIf="content.entity.fieldEventMainDate" class="child">
              <span>
                {{ 'time.'+ (content.entity.fieldEventMainDate.unix*1000 | weekday: "unix" | lowercase) | translate }}
                {{ content.entity.fieldEventMainDate.unix*1000 | date: "dd.MM yyy "}}

                <span *ngIf="content.entity.fieldEventMainStartTime && content.entity.fieldEventMainEndTime">
                  <span> {{ 'time.time_of_day' | translate }}</span>
                  <ng-container *ngIf="content.entity.fieldEventMainStartTime">
                    {{ content.entity.fieldEventMainStartTime | unixToTime  }}
                  </ng-container>
                  <ng-container *ngIf="content.entity.fieldEventMainStartTime && content.entity.fieldEventMainEndTime">
                    -
                  </ng-container>
                  <ng-container *ngIf="content.entity.fieldEventMainEndTime">
                    {{ content.entity.fieldEventMainEndTime | unixToTime  }}
                  </ng-container>
                </span>
                
              </span>
              <ng-container *ngIf="content.entity && content.entity.fieldEventDate">
                <div *ngFor="let item of content.entity.fieldEventDate">
                  <ng-container *ngIf="item.entity.fieldEventDate">
                    {{ 'time.'+ (item.entity.fieldEventDate.unix*1000 | weekday: "unix" | lowercase) | translate }}
                    {{ item.entity.fieldEventDate.unix*1000 | date: "dd.MM yyy "}}

                    <span *ngIf="item.entity.fieldEventStartTime || item.entity.fieldEventEndTime">
                      <span> {{ 'time.time_of_day' | translate }}</span>
                      <ng-container *ngIf="item.entity.fieldEventStartTime">
                        {{ item.entity.fieldEventStartTime | unixToTime  }}
                      </ng-container>
                      <ng-container *ngIf="item.entity.fieldEventStartTime && item.entity.fieldEventEndTime">
                        -
                      </ng-container>
                      <ng-container *ngIf="item.entity.fieldEventEndTime">
                        {{ item.entity.fieldEventEndTime | unixToTime  }}
                      </ng-container>
                    </span>
                  </ng-container>
                </div>
              </ng-container>
            </div><!--/child-->
          </div><!--/events__list__item__body-->
        </ng-container>
      </ng-container>
    </div>
    <div class="events__list__item__footer">
      <div tabindex="0" *ngIf="content.entity.fieldEventLocation">{{ content.entity.fieldEventLocation.name }}</div>
      <div *ngIf="content.entity.fieldEventLocationLink"><a [href]="content.entity.fieldEventLocationLink.uri" target="_blank" class="link-ellipsis" role="link" attr.aria-label="{{ content.entity.fieldEventLocationLink.uri | removeProtocol }}">{{ content.entity.fieldEventLocationLink.uri | removeProtocol }}</a></div>
    </div>
  </div>
</div>

<div class="events__list__recent" *ngIf="content.entity.fieldOrganizer ||
  content.entity.fieldContactPerson ||
  content.entity.fieldContactPhone ||
  content.entity.fieldContactEmail">
  <div class="events__list__item">
    <div class="title"><h1>{{'event.contact' | translate}}</h1></div>
    <div class="events__list__item__body">
      <div class="child" tabindex="0" role="text" attr.aria-label="{{'event.organizer' | translate}} {{ content.entity.fieldOrganizer ? content.entity.fieldOrganizer : '' }}">{{ content.entity.fieldOrganizer ? content.entity.fieldOrganizer : '' }}</div>
      <div class="child" tabindex="0" role="text" attr.aria-label="{{'event.person | translate'}} {{ content.entity.fieldContactPerson }}">{{ content.entity.fieldContactPerson }}</div>
      <div class="child" tabindex="0" role="text" attr.aria-label="{{'event.phone | translate'}} {{ content.entity.fieldContactPhone }}">{{ content.entity.fieldContactPhone }}</div>
      <a href="mailto:{{content.entity.fieldContactEmail}}" class="child" role="link"  attr.aria-label="{{'e-mail'}} {{ content.entity.fieldContactEmail }}">{{ content.entity.fieldContactEmail }}</a>
    </div>
  </div>
</div>

<div class="events__list__recent" *ngIf="content.entity.fieldPracticalInformation">
  <div class="events__list__item">
    <div class="title"><h1>{{'event.practical_info' | translate}}</h1></div>
    <div class="events__list__item__body inner" *ngIf="content.entity.fieldPracticalInformation" [innerHtml]="content.entity.fieldPracticalInformation.value"></div>
  </div>
</div>